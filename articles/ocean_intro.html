<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="ocean">
<title>ocEAn Intro • ocean</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="ocEAn Intro">
<meta property="og:description" content="ocean">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">ocean</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/metabolic_pathway_enrichment.html">Metabolite Enrichment Analysis</a>
    <a class="dropdown-item" href="../articles/ocean_intro.html">ocEAn Intro</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/saezlab/ocean/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://twitter.com/saezlab">
    <span class="fab fa fab fa-twitter fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://saezlab.org">
    <span class="fas fa fas fa-university"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>ocEAn Intro</h1>
                        <h4 data-toc-skip class="author">A. Dugourd</h4>
            
            <h4 data-toc-skip class="date">12/01/2023</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/saezlab/ocean/blob/HEAD/vignettes/ocean_intro.Rmd" class="external-link"><code>vignettes/ocean_intro.Rmd</code></a></small>
      <div class="d-none name"><code>ocean_intro.Rmd</code></div>
    </div>

    
    
<p>OCEAN: a method that defines metabolic enzyme footprint from a
curated reduced version of the recon2 reaction network. The metabolic
enzyme footprints are used to explore coordinated deregulations of
metabolite abundances with respect to their position relative to
metabolic enzymes. This is similar to Kinase-substrate and TF-targets
enrichment analyses.</p>
<div class="section level2">
<h2 id="install-ocean">Install ocEAn<a class="anchor" aria-label="anchor" href="#install-ocean"></a>
</h2>
<pre><code><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/" class="external-link">devtools</a></span><span class="op">)</span></span>
<span><span class="fu">install_github</span><span class="op">(</span><span class="st">"saezlab/ocean"</span><span class="op">)</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="tutorial-with-a-kidney-cancer-toy-metabolomic-dataset">Tutorial with a kidney cancer toy metabolomic dataset<a class="anchor" aria-label="anchor" href="#tutorial-with-a-kidney-cancer-toy-metabolomic-dataset"></a>
</h2>
<pre><code><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://saezlab.github.io/ocean/" class="external-link">ocean</a></span><span class="op">)</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="differential-analysis">Differential analysis<a class="anchor" aria-label="anchor" href="#differential-analysis"></a>
</h2>
<p>With data from: <a href="https://www.embopress.org/doi/full/10.15252/msb.20209730" class="external-link uri">https://www.embopress.org/doi/full/10.15252/msb.20209730</a>.</p>
<pre><code><span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">toy_targets</span><span class="op">$</span><span class="va">condition</span><span class="op">)</span></span>
<span><span class="va">comparisons</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">'tumorVsHealthy'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="op">-</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">limmaRes</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runLimma.html">runLimma</a></span><span class="op">(</span>measurements <span class="op">=</span> <span class="va">toy_metabolomic_data</span>,</span>
<span>                     targets <span class="op">=</span> <span class="va">toy_targets</span>,</span>
<span>                     comparisons <span class="op">=</span> <span class="va">comparisons</span><span class="op">)</span></span></code></pre>
<p>This differential anaylsis result represents metabolic up and
down-regulations of metabolite abundances in kidney tumor tissue
compared to adjacent non-tumoral tissue.</p>
</div>
<div class="section level2">
<h2 id="format-differential-analysis-result">Format differential analysis result<a class="anchor" aria-label="anchor" href="#format-differential-analysis-result"></a>
</h2>
<p>In order to assess the metabolic imbalance, we use the t statistic of
the differential analysis. The t-statistic represents a good estimate of
the relative significance of up and down-regulations of metabolic
abundances.</p>
<pre><code><span><span class="va">t_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ttop_list_to_t_table.html">ttop_list_to_t_table</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/limma_res_to_ttop_list.html">limma_res_to_ttop_list</a></span><span class="op">(</span>limma_res <span class="op">=</span> <span class="va">limmaRes</span>,</span>
<span>                         comp_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">comparisons</span><span class="op">)</span>,</span>
<span>                         number <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">toy_metabolomic_data</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                         adjust.method <span class="op">=</span> <span class="st">"fdr"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="next-the-metabolic-names-have-to-be-converted-to-a-standard-identifer-">Next, the metabolic names have to be converted to a standard
identifer.<a class="anchor" aria-label="anchor" href="#next-the-metabolic-names-have-to-be-converted-to-a-standard-identifer-"></a>
</h2>
<p>In this case, we use KEGG IDs. This step is particularly important
because this is where the users metabolic identifiers are mapped to the
kegg ids used by the method.</p>
<p><strong>THE USER SHOULD PROVIDE A MAPPING TABLE IN THE SAME FORMAT AS
THE ONE PRESENTED HERE.</strong> (You can look at it to inspire yourself
from it.) The mapping table should map the users own metabolic
identifiers to kegg compound IDs.</p>
<pre><code><span><span class="va">t_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/t_table_metactivity_input_formater.html">t_table_metactivity_input_formater</a></span><span class="op">(</span></span>
<span>  metabolomic_t_table <span class="op">=</span> <span class="va">t_table</span>,</span>
<span>  mapping_table <span class="op">=</span> <span class="va">mapping_table</span>,</span>
<span>  affixes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"c"</span>,<span class="st">"l"</span>,<span class="st">"x"</span>,<span class="st">"m"</span>,<span class="st">"e"</span>,<span class="st">"n"</span>,<span class="st">"r"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="these-are-the-available-pathways-to-choose-from">These are the available pathways to choose from<a class="anchor" aria-label="anchor" href="#these-are-the-available-pathways-to-choose-from"></a>
</h2>
<pre><code><span><span class="fu"><a href="https://rdrr.io/r/utils/View.html" class="external-link">View</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">recon2_redhuman</span><span class="op">$</span><span class="va">pathway</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="subnetworks">Subnetworks<a class="anchor" aria-label="anchor" href="#subnetworks"></a>
</h2>
<pre><code><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">expressed_genes</span><span class="op">)</span></span></code></pre>
<p>In this case, we will use all pathways available. Users can restrict
this list on a per-need basis.</p>
<pre><code><span><span class="va">all_pathways</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">recon2_redhuman</span><span class="op">$</span><span class="va">pathway</span><span class="op">)</span></span>
<span><span class="va">sub_network</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/model_to_pathway_sif.html">model_to_pathway_sif</a></span><span class="op">(</span>pathway_to_keep <span class="op">=</span> <span class="va">all_pathways</span><span class="op">$</span><span class="va">X1</span><span class="op">)</span></span></code></pre>
<p>Some formating of the network is required, especially to make the
method easier to run and the results easier to interpret.</p>
<p>This step simply translate the gene IDs in the enzyme complexes into
gene symbols:</p>
<pre><code><span><span class="va">sub_network</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/translate_complexes.html">translate_complexes</a></span><span class="op">(</span><span class="va">sub_network</span><span class="op">)</span></span></code></pre>
<p>Co-factors are removed. since we are aiming to follow metabolic
routes in the metabolic reaction network, it is crucial to remove
over-promiscuous metabolites that create unnecessary complexity in the
network.</p>
<pre><code><span><span class="va">sub_network_nocofact</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/remove_cofactors.html">remove_cofactors</a></span><span class="op">(</span><span class="va">sub_network</span><span class="op">)</span></span></code></pre>
<p>Filter out any gene that isn’t expressed from the metabolic
network:</p>
<pre><code><span><span class="va">non_expressed_genes</span> <span class="op">&lt;-</span> <span class="va">expressed_genes</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">expressed_genes</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>,drop <span class="op">=</span> <span class="cn">F</span><span class="op">]</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>,drop <span class="op">=</span> <span class="cn">F</span><span class="op">]</span></span>
<span><span class="va">non_expressed_genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">non_expressed_genes</span><span class="op">$</span><span class="va">gene</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tokeep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">sub_network_nocofact</span><span class="op">$</span><span class="va">reaction_network</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">{</span></span>
<span>  <span class="va">elements</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"[&gt;&lt;].*"</span>,<span class="st">""</span>,<span class="va">sub_network_nocofact</span><span class="op">$</span><span class="va">reaction_network</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">elements</span> <span class="op">&lt;-</span> <span class="va">elements</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"cpd:"</span>,<span class="va">elements</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="va">elements</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span><span class="va">elements</span>, <span class="st">"_"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">tokeep</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">elements</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">non_expressed_genes</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span></span>
<span><span class="op">}</span></span>
<span><span class="va">tokeep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">tokeep</span><span class="op">)</span></span>
<span><span class="va">sub_network_nocofact</span><span class="op">$</span><span class="va">reaction_network</span> <span class="op">&lt;-</span> <span class="va">sub_network_nocofact</span><span class="op">$</span><span class="va">reaction_network</span><span class="op">[</span><span class="va">tokeep</span>,<span class="op">]</span></span></code></pre>
<p>Compress transporters to simplify the network:</p>
<pre><code><span><span class="va">sub_network_nocofact</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compress_transporters.html">compress_transporters</a></span><span class="op">(</span>sub_network_nocofact <span class="op">=</span> <span class="va">sub_network_nocofact</span><span class="op">)</span></span></code></pre>
<p>Split transaminases to preserve correct metabolic transformation
routes:</p>
<pre><code><span><span class="va">sub_network_nocofact</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/split_transaminases.html">split_transaminases</a></span><span class="op">(</span>sub_network_nocofact <span class="op">=</span> <span class="va">sub_network_nocofact</span><span class="op">)</span></span>
<span></span>
<span><span class="va">enzymes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">sub_network_nocofact</span><span class="op">$</span><span class="va">attributes</span><span class="op">$</span><span class="va">V1</span><span class="op">)</span></span>
<span><span class="va">enzymes</span> <span class="op">&lt;-</span> <span class="va">enzymes</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"_[clxmenr]$"</span>,<span class="va">enzymes</span><span class="op">)</span><span class="op">]</span></span></code></pre>
<p>Convert the network into a forest (list of enzymes (trees) with
correspoding metabolic signatures (branches)):</p>
<pre><code><span><span class="va">sub_forest</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/forestMaker.html">forestMaker</a></span><span class="op">(</span><span class="va">enzymes</span>, <span class="va">sub_network_nocofact</span><span class="op">$</span><span class="va">reaction_network</span>, branch_length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, remove_reverse <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="prepare-the-metabolic-enzyme-sets">Prepare the metabolic enzyme sets<a class="anchor" aria-label="anchor" href="#prepare-the-metabolic-enzyme-sets"></a>
</h2>
<pre><code><span><span class="va">penalty_min</span> <span class="op">&lt;-</span> <span class="fl">6</span> <span class="co">#minimum 1 and integer</span></span>
<span><span class="va">penalty_max</span> <span class="op">&lt;-</span> <span class="fl">8</span> <span class="co">#maximum 9 and integer</span></span>
<span></span>
<span><span class="va">reaction_set_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prepare_metabolite_set.html">prepare_metabolite_set</a></span><span class="op">(</span></span>
<span>  penalty_range <span class="op">=</span> <span class="va">penalty_min</span><span class="op">:</span><span class="va">penalty_max</span>,</span>
<span>  forest <span class="op">=</span> <span class="va">sub_forest</span>,</span>
<span>  measured_metabolites <span class="op">=</span> <span class="va">t_table</span><span class="op">$</span><span class="va">KEGG</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">reaction_set_list_merged</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/condense_metabolite_set.html">condense_metabolite_set</a></span><span class="op">(</span>reaction_set_list <span class="op">=</span> <span class="va">reaction_set_list</span><span class="op">)</span></span>
<span></span>
<span><span class="va">penalty</span> <span class="op">&lt;-</span> <span class="fl">8</span> <span class="co">#has be between penalty_min and penalty_max and integer</span></span>
<span></span>
<span><span class="va">regulons_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prepare_regulon_df.html">prepare_regulon_df</a></span><span class="op">(</span></span>
<span>  <span class="va">reaction_set_list_merged</span>,</span>
<span>  <span class="va">penalty</span>,</span>
<span>  filter_imbalance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="compute-metabolic-enzme-enrichment-score">Compute metabolic enzme enrichment score<a class="anchor" aria-label="anchor" href="#compute-metabolic-enzme-enrichment-score"></a>
</h2>
<pre><code><span><span class="va">metactivity_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/metactivity.html">metactivity</a></span><span class="op">(</span>metabolomic_t_table <span class="op">=</span> <span class="va">t_table</span>,</span>
<span>                               regulons_df <span class="op">=</span> <span class="va">regulons_df</span>,</span>
<span>                               compartment_pattern <span class="op">=</span> <span class="st">"_[a-z]$"</span>,</span>
<span>                               k <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mean_ES_df</span> <span class="op">&lt;-</span> <span class="va">metactivity_res</span><span class="op">$</span><span class="va">ES</span></span>
<span></span>
<span><span class="va">mean_NES_df</span> <span class="op">&lt;-</span> <span class="va">metactivity_res</span><span class="op">$</span><span class="va">NES</span></span></code></pre>
<pre><code><span><span class="va">translated_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/translate_results.html">translate_results</a></span><span class="op">(</span>regulons_df <span class="op">=</span> <span class="va">regulons_df</span>, t_table <span class="op">=</span> <span class="va">t_table</span>, mapping_table <span class="op">=</span> <span class="va">mapping_table</span>, compress_compartments <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="visualise-results-for-single-enzymes">Visualise results for single enzymes<a class="anchor" aria-label="anchor" href="#visualise-results-for-single-enzymes"></a>
</h2>
<pre><code><span><span class="va">plots</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotMetaboliteContribution.html">plotMetaboliteContribution</a></span><span class="op">(</span></span>
<span>  enzyme <span class="op">=</span> <span class="st">'OGDH_DLD_PDH_DLST&gt;1052'</span>,</span>
<span>  stat_df <span class="op">=</span> <span class="va">translated_results</span><span class="op">$</span><span class="va">t_table</span>,</span>
<span>  metabolite_sets <span class="op">=</span> <span class="va">translated_results</span><span class="op">$</span><span class="va">regulons_df</span>,</span>
<span>  contrast_index <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  stat_name <span class="op">=</span> <span class="st">'Abundance Down &lt;==&gt; Up (t-value)'</span>,</span>
<span>  scaling_factor <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  nLabels <span class="op">=</span>  <span class="fl">25</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">plots</span><span class="op">$</span><span class="va">scatter</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plots</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotMetaboliteContribution.html">plotMetaboliteContribution</a></span><span class="op">(</span></span>
<span>  enzyme <span class="op">=</span> <span class="st">'BCAT1'</span>,</span>
<span>  stat_df <span class="op">=</span> <span class="va">translated_results</span><span class="op">$</span><span class="va">t_table</span>,</span>
<span>  metabolite_sets <span class="op">=</span> <span class="va">translated_results</span><span class="op">$</span><span class="va">regulons_df</span>,</span>
<span>  contrast_index <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  stat_name <span class="op">=</span> <span class="st">'Abundance Down &lt;==&gt; Up (t-value)'</span>,</span>
<span>  scaling_factor <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  nLabels <span class="op">=</span>  <span class="fl">25</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">plots</span><span class="op">$</span><span class="va">scatter</span><span class="op">)</span></span></code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## R version 4.2.2 (2022-10-31)</span></span>
<span><span class="co">## Platform: x86_64-pc-linux-gnu (64-bit)</span></span>
<span><span class="co">## Running under: Ubuntu 22.04.1 LTS</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3</span></span>
<span><span class="co">## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">##  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">##  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">##  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">## [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##  [1] knitr_1.41        magrittr_2.0.3    R6_2.5.1          ragg_1.2.5       </span></span>
<span><span class="co">##  [5] rlang_1.0.6       fastmap_1.1.0     stringr_1.5.0     tools_4.2.2      </span></span>
<span><span class="co">##  [9] xfun_0.36         cli_3.6.0         jquerylib_0.1.4   systemfonts_1.0.4</span></span>
<span><span class="co">## [13] htmltools_0.5.4   yaml_2.3.6        digest_0.6.31     rprojroot_2.0.3  </span></span>
<span><span class="co">## [17] lifecycle_1.0.3   pkgdown_2.0.7     textshaping_0.3.6 purrr_1.0.1      </span></span>
<span><span class="co">## [21] sass_0.4.4        vctrs_0.5.1       fs_1.5.2          memoise_2.0.1    </span></span>
<span><span class="co">## [25] glue_1.6.2        cachem_1.0.6      evaluate_0.19     rmarkdown_2.19   </span></span>
<span><span class="co">## [29] stringi_1.7.12    compiler_4.2.2    bslib_0.4.2       desc_1.4.2       </span></span>
<span><span class="co">## [33] jsonlite_1.8.4</span></span></code></pre>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Aurélien Dugourd.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
